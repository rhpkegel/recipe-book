<div class="zoom-controls">
  <div class="sticky-container">
    <button [disabled]="(recipeWidth >= 50 && doublePage) || (recipeWidth >= 100)" (click)="zoomInRecipe()">
      <ng-icon name="heroMagnifyingGlassPlus"></ng-icon>
    </button>
    <button [disabled]="recipeWidth <= 20" (click)="zoomOutRecipe()">
      <ng-icon name="heroMagnifyingGlassMinus"></ng-icon>
    </button>
    <button (click)="doublePageToggle()">
      <ng-icon name="heroBookOpen"></ng-icon>
    </button>
  </div>
</div>

<div class="container">
  <div class="sidebar">
    <div cdkDropList class="recipe-list" (cdkDropListDropped)="drop($event)">
      <h1 class="recipe-list__header">Recipes</h1>
      <div class="recipe-list__row"
           [class.active]="i==activeRecipeIndex"
           (click)="this.activeRecipeIndex=i"
           *ngFor="let recipe of recipes; index as i"
           cdkDrag>
        {{recipe.title ? recipe.title : 'Untitled Recipe'}}
        <button (click)="deleteRecipe(i)" mat-icon-button>X</button>
      </div>
    </div>
  </div>

  <div class="content">
    <ng-container *ngIf="!printing">
      <app-recipe-page
        [recipe]="this.recipes[this.activeRecipeIndex]"
        (pageClicked)="activeRecipeIndex = activeRecipeIndex > 0 ? activeRecipeIndex - 1 : activeRecipeIndex"
        [width]="recipeWidth"
      ></app-recipe-page>
      <app-recipe-page *ngIf="doublePage"
                       [recipe]="this.activeRecipeIndex+1 < this.recipes.length ? this.recipes[this.activeRecipeIndex+1] : undefined"
                       (pageClicked)="activeRecipeIndex = activeRecipeIndex < recipes.length-1 ? activeRecipeIndex + 1 : activeRecipeIndex"
                       [width]="recipeWidth"
      ></app-recipe-page>
    </ng-container>
    <ng-container *ngIf="printing">
      <ng-container *ngFor="let recipe of recipes; let i = index; let even = even">
        <ng-container *ngIf="even">
          <div class="print-row">
            <app-recipe-page
              [recipe]="recipes[i]"
              [width]="49"
            ></app-recipe-page>
            <app-recipe-page
              [recipe]="recipes[i+1]"
              [width]="49"
            ></app-recipe-page>
          </div>
        </ng-container>
      </ng-container>
    </ng-container>
  </div>

  <div class="footer">
    <button mat-button color="primary" (click)="initRecipe()">New recipe</button>
    <button mat-button color="primary" (click)="fileUpload.click()">
      Load from disk
    </button>
    <input [(ngModel)]="selectedRecipes" (change)="updateCurrentRecipe($event)" #fileUpload type="file" multiple
           placeholder="-">
    <button mat-button color="primary" (click)="downloadURI()">Save to disk</button>
    <button mat-button color="primary" (click)="printRecipe()">Print RecipeBook</button>
  </div>
</div>
